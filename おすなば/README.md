# 勤務表から小口作成ツール

## 概要
本ツールは勤務表をもとに小口交通費・出張旅費精算明細書（以下、小口）を作成するツールです。

## 注意事項/前提条件
* 本ツールは勤務表をもとに勤務地の情報を登録し、小口交通費・出張旅費精算明細書を作成します。そのため、必ず記入済みの勤務表をダウンロードしてください。
* 勤務内容と作業場所欄から勤務表の情報を取得しています。
* 勤務表のフォルダ名が以下の形式となっているか確認し、順番や桁数などが異なる場合は修正してから batファイル を実行してください。

    ※この形式以外だとツールが読み取れない可能性があります。
    ~~~
    勤務表ファイル名の形式
    　<3桁の社員番号>_勤務表_YYYYMM_<氏名>.xlsx

    　（例）001_勤務表_202106_ボパリ太郎.xlsx
    ~~~
* 下記の実行前フォルダ構成と比べて不足しているもの（あれば）

    ※フォルダを消してしまった場合やフォルダ名を変更してしまった場合は、下記の「実行前フォルダ構成」と同じになるように追加・編集してください

* 2021年6月現在の勤務表や小口の形式に合わせて作成したツールです。テンプレートが変更された場合など、対応しきれない場合があります。ご了承ください。

## ツールを動かす前に用意するもの
* 記入済みの勤務表（実行前フォルダ構成の★がついたファイル）

## 実行前フォルダ構成
~~~
勤務表から小口作成ツール								
│								
├ダウンロードした勤務表
│	│ ※このフォルダ配下に、小口を作成したい月の勤務表（★）を格納してください		
│	│
│	├001_勤務表_202106_ボパリ太郎.xlsx ★			
│	├001_勤務表_202107_ボパリ太郎.xlsx ★					
│	├001_勤務表_202109_ボパリ太郎.xlsx ★					
│	・							
│	・							
│								
├作成済小口明細書							
│				
├resources							
│	├picutures						
│	│	└お待ちください猫.png					
│	├scripts						
│	│	└勤務表から月選択.ps1					
│	│
│	├小口テンプレ
│	│
│	└ツール用引数.txt						
│								
├勤務表から小口作成.bat							
│								
├初期設定・上書き設定.bat							
│								
├初期化.bat（仮）							
│								
└README.md							
~~~


## 使用方法

1. SharePoint(https://bhopari.sharepoint.com/:f:/s/msteams_8a5eaf/Epp0RNYmlwZNk8PPYZVXPwsBT1TRc6lQVxAZLozPV0Oa5A?e=Qd0fy7)から「ダウンロードした勤務表」フォルダに勤務表をダウンロードする。

2. 「初期設定・上書き設定.bat」をダブルクリックし、案内に従って勤務地の登録をする。

3. 「勤務表から小口作成.bat」をダブルクリックし、案内に従って作成したい小口の対象年月を選択する。

4. 「作成済小口明細書」フォルダに作成された小口（実行後フォルダ構成図の☆がついたファイル）に不備がないか確認する。
    ~~~
    <利用者自身が行うこと>
    ・仮払い金額の記入（この機能を搭載するか・・・？）
    ・「以下余白」の記入

    <その他の見落としがちなチェックポイント>
    ・記入された小口の日数、日程、場所、金額などに間違いはないか
    ・氏名、所属に間違いはないか
    ・印鑑がコピーされているか
    ~~~

5. 登録した勤務地の情報を変更したい場合、 「初期化.bat」をダブルクリックし、登録した情報全てを削除する。
    ~~~
    <以下のような場合は初期化する>
    ・登録情報を間違えてしまった
    ・引っ越し等により区間や交通費が変更になった
    ・バスや鉄道の運賃改定により交通費が変更になった
    ~~~

## 実行後フォルダ構成
~~~
勤務表から小口作成ツール								
│								
├ダウンロードした勤務表							
│	├001_勤務表_202106_ボパリ太郎.xlsx						
│	├001_勤務表_202107_ボパリ太郎.xlsx						
│	├001_勤務表_202109_ボパリ太郎.xlsx						
│	・							
│	・							
│								
├作成済小口明細書
│	│ ※このフォルダ配下に、作成された小口（☆）が格納されています		
│	│						
│	├001_小口交通費・出張旅費精算明細書_202106_ボパリ太郎.xlsx ☆
│	├001_小口交通費・出張旅費精算明細書_202107_ボパリ太郎.xlsx ☆
│	・							
│	・							
│								
├resources							
│	├picutures						
│	│	└お待ちください猫.png					
│	├scripts						
│	│	└勤務表から月選択.ps1					
│	│
│	├小口テンプレ
│	│
│	└ツール用引数.txt							
│								
├勤務表から小口作成.bat							
│								
├初期設定・上書き設定.bat							
│								
├初期化.bat（仮）							
│								
└README.md							
~~~


## よくある質問

* 「」と表示されたのですが、どうすればいいですか？

    →